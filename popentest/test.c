#include <stdio.h>
#include <sys/wait.h>
#include <string>
using namespace std;

int main(void)
{
    int iRet = 0;
    FILE *fp = NULL;
    char buff[512] = {'\0'};

    string execCmd = "python3 uploadMp4.py";
    string mp4UploadPath = "saimo/mp4/uuid/AEB_1.mp4";
    string miles = "300";
    string xoscFileName = "AEB.xosc"; //
    
    execCmd += " ";
    execCmd += mp4UploadPath;
    execCmd += " ";
    execCmd += miles;
    execCmd += " ";
    execCmd += xoscFileName;

    // uploadMp4.py
    fp = popen(execCmd.c_str(), "r");
    if (NULL == fp)
    {
        printf("popen failed.\n");
        return 1;
    }

    while(fgets(buff, sizeof(buff), fp) != NULL)
    {
        printf("%s", buff);
    }

    iRet = pclose(fp);
    printf("iRet = %d\n", iRet);
    printf("exit :%d\n", WEXITSTATUS(iRet));

    return 0;
}